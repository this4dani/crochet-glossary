<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DANI'S - Crochet Stitch Glossary</title>
  <meta name="description" content="Interactive crochet stitch glossary with US/UK terminology. 60+ stitches with search and detailed descriptions.">
  
  <!-- Link to your master CSS file -->
  <link rel="stylesheet" href="styles.css">
  
  <!-- SVG Symbol Definitions -->
  <svg style="display: none;">
    <defs>
      <!-- Basic stitches -->
      <symbol id="x" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="3" fill="currentColor"/>
        <path d="M8 8l8 8m-8 0l8-8" stroke="currentColor" stroke-width="2"/>
      </symbol>
      <symbol id="T" viewBox="0 0 24 24">
        <path d="M12 2v20M6 6h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </symbol>
      <symbol id="H" viewBox="0 0 24 24">
        <path d="M12 2v20M6 12h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </symbol>
      <symbol id="TT" viewBox="0 0 24 24">
        <path d="M12 2v20M6 4h12M6 8h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </symbol>
      <symbol id="o" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="8" fill="none" stroke="currentColor" stroke-width="2"/>
      </symbol>
      <symbol id="-" viewBox="0 0 24 24">
        <path d="M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </symbol>
      <!-- Advanced stitches -->
      <symbol id="V" viewBox="0 0 24 24">
        <path d="M8 6l4 12 4-12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </symbol>
      <symbol id="Sh" viewBox="0 0 24 24">
        <path d="M6 18c3-6 9-6 12 0" stroke="currentColor" stroke-width="2" fill="none"/>
        <path d="M8 18l2-4 2 4 2-4 2 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
      </symbol>
      <symbol id="pc" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="6" fill="currentColor"/>
        <circle cx="12" cy="12" r="3" fill="white"/>
      </symbol>
      <symbol id="cl" viewBox="0 0 24 24">
        <path d="M8 6v12M12 6v12M16 6v12M6 18h12" stroke="currentColor" stroke-width="2"/>
      </symbol>
      <!-- Generic symbol for others -->
      <symbol id="default" viewBox="0 0 24 24">
        <rect x="4" y="4" width="16" height="16" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
        <path d="M9 9h6v6H9z" fill="currentColor"/>
      </symbol>
    </defs>
  </svg>
</head>
<body>
  <div class="container">
    <!-- FIXED: Changed from "ad-zone ad-zone-header" to "adsense-top" -->
    <div class="adsense-top">
      [Google AdSense - Leaderboard 728x90]
    </div>

    <!-- Navigation - Uses images from your main design -->
    <nav id="nav">
        <a href="index.html">
            <img src="images/home-heart-door.png" alt="Home">
        </a>
        <a href="glossary.html" class="active">
            <img src="images/file-folder-magazne-lable.png" alt="Glossary">
        </a>
        <a href="story.html">
            <img src="images/slip-knot-first-chain.png" alt="Story">
        </a>
        <a href="follow.html">
            <img src="images/yarn-ball-insert-crochet-hook.png" alt="Social">
        </a>
    </nav>

    <header class="header">
      <h1>Interactive Crochet Glossary</h1>
      <p>Your comprehensive guide to crochet stitches and techniques</p>
    </header>

    <!-- Ad Zone - Sidebar (Desktop) -->
    <div class="ad-zone ad-zone-sidebar">
      [Google AdSense - Medium Rectangle 300x250]
    </div>

    <!-- Container with warmer color - using rich brown -->
    <div class="glossary-content-container" style="
      background: var(--clr-rich-brown);
      border-radius: 25px;
      padding: 40px;
      margin: 30px 0;
      box-shadow: 
        0 15px 35px rgba(74, 44, 42, 0.4),
        0 8px 20px rgba(0, 0, 0, 0.3),
        inset 0 3px 6px rgba(255, 255, 255, 0.12);
      border: 1px solid rgba(250, 248, 243, 0.15);
    ">

    <div class="search-section">
      <div class="tips-toggle" onclick="toggleTips()">
        Tips & Tricks â–¼
        <div class="tips-content" id="tips-content">
          <p><strong>Browse:</strong> Scroll through all stitches</p>
          <p><strong>Search:</strong> Type abbreviation or full name</p>
          <p><strong>Hover:</strong> See full stitch name</p>
          <p><strong>Click:</strong> View detailed popup with US/UK terms</p>
        </div>
      </div>
      <input type="text" id="search" placeholder="Try 'single', 'dc', or 'texture'...">
    </div>

    <div id="glossary-grid"></div>

    </div> <!-- Close glossary-content-container -->

    <!-- Ad Zone - Footer Banner -->
    <div class="ad-zone ad-zone-footer">
      [Google AdSense - Footer Banner 728x90]
    </div>
  </div>

  <!-- Glossary Data -->
  <script src="glossarydata.js"></script>

  <!-- FIXED: Updated JavaScript for better scroll performance -->
  <script>
    // SYNCHRONIZED NAVIGATION BEHAVIOR - IMPROVED PERFORMANCE
    let navigationTicking = false;

    function updateNavigationState() {
        const nav = document.getElementById('nav');
        const scrollY = window.scrollY;
        
        if (scrollY > 40) {  // Consistent trigger point
            nav.classList.add('scrolled');
        } else {
            nav.classList.remove('scrolled');
        }
        navigationTicking = false;
    }

    function requestNavigationTick() {
        if (!navigationTicking) {
            requestAnimationFrame(updateNavigationState);
            navigationTicking = true;
        }
    }

    window.addEventListener('scroll', requestNavigationTick, { passive: true });

    // Tips toggle functionality
    function toggleTips() {
      const tipsContent = document.getElementById('tips-content');
      tipsContent.style.display = tipsContent.style.display === 'block' ? 'none' : 'block';
    }

    // Glossary search and display functionality
    let allStitches = [];
    let filteredStitches = [];

    function initGlossary() {
      // Use stitches data from glossarydata.js
      if (typeof stitchesData !== 'undefined') {
        allStitches = stitchesData;
        filteredStitches = [...allStitches];
        displayStitches();
        setupSearch();
      } else {
        document.getElementById('glossary-grid').innerHTML = '<p>Error: Stitch data not loaded</p>';
      }
    }

    function displayStitches() {
      const grid = document.getElementById('glossary-grid');
      grid.innerHTML = '';

      if (filteredStitches.length === 0) {
        grid.innerHTML = '<p style="text-align: center; color: var(--clr-cream); margin: 40px 0;">No stitches found. Try a different search term.</p>';
        return;
      }

      filteredStitches.forEach(stitch => {
        const stitchElement = createStitchElement(stitch);
        grid.appendChild(stitchElement);
      });
    }

    function createStitchElement(stitch) {
      const stitchDiv = document.createElement('div');
      stitchDiv.className = 'stitch-item';
      stitchDiv.onclick = () => showStitchDetail(stitch);
      
      // Get symbol for the stitch
      const symbolId = getStitchSymbol(stitch.abbreviation);
      
      stitchDiv.innerHTML = `
        <div class="stitch-symbol">
          <svg><use href="#${symbolId}"></use></svg>
        </div>
        <div class="stitch-info">
          <div class="stitch-abbrev">${stitch.abbreviation}</div>
          <div class="stitch-name">${stitch.name}</div>
        </div>
      `;
      
      return stitchDiv;
    }

    function getStitchSymbol(abbreviation) {
      const symbolMap = {
        'sc': 'x',
        'dc': 'T', 
        'hdc': 'H',
        'tr': 'TT',
        'sl st': '-',
        'ch': 'o',
        'inc': 'V',
        'dec': 'cl',
        'shell': 'Sh',
        'pc': 'pc'
      };
      return symbolMap[abbreviation.toLowerCase()] || 'default';
    }

    function showStitchDetail(stitch) {
      const modal = document.createElement('div');
      modal.className = 'stitch-modal';
      modal.onclick = (e) => {
        if (e.target === modal) {
          document.body.removeChild(modal);
        }
      };

      modal.innerHTML = `
        <div class="modal-content">
          <span class="close-modal" onclick="document.body.removeChild(this.closest('.stitch-modal'))">&times;</span>
          <h2>${stitch.name}</h2>
          <p><strong>Abbreviation:</strong> ${stitch.abbreviation}</p>
          <p><strong>Description:</strong> ${stitch.description}</p>
          ${stitch.instructions ? `<p><strong>Instructions:</strong> ${stitch.instructions}</p>` : ''}
          ${stitch.usTerms ? `<p><strong>US Terms:</strong> ${stitch.usTerms}</p>` : ''}
          ${stitch.ukTerms ? `<p><strong>UK Terms:</strong> ${stitch.ukTerms}</p>` : ''}
          ${stitch.tips ? `<p><strong>Tips:</strong> ${stitch.tips}</p>` : ''}
        </div>
      `;

      document.body.appendChild(modal);
    }

    function setupSearch() {
      const searchInput = document.getElementById('search');
      searchInput.addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        filteredStitches = allStitches.filter(stitch => 
          stitch.name.toLowerCase().includes(searchTerm) ||
          stitch.abbreviation.toLowerCase().includes(searchTerm) ||
          stitch.description.toLowerCase().includes(searchTerm)
        );
        displayStitches();
      });
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', initGlossary);
  </script>
</body>
</html>